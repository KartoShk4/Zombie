/* ============================================
   СОСТОЯНИЕ ИГРЫ
   ============================================
   Управление глобальным состоянием игры:
   флаги запуска, паузы, камеры и другие
   основные переменные состояния.
   ============================================ */

// ===== ОПРЕДЕЛЕНИЕ ПЛАТФОРМЫ =====
/**
 * Проверка, является ли устройство мобильным
 * Определяется по User-Agent браузера
 */
const isMobile = /Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent);

// ===== СОСТОЯНИЕ ИГРЫ =====
/**
 * Флаг запуска игры
 * true - игра запущена, false - игра не запущена
 */
let gameStarted = false;

/**
 * Флаг паузы
 * true - игра на паузе, false - игра активна
 */
let isPaused = false;

/**
 * Позиция камеры в мировых координатах
 * Камера следует за игроком
 */
let camera = { x: 0, y: 0 };

// ===== ВИЗУАЛЬНЫЕ ЭФФЕКТЫ =====
/**
 * Интенсивность вспышки при выстреле
 * Уменьшается со временем, используется для отрисовки вспышки
 */
let muzzleFlash = 0;

/**
 * Мерцание света (0.9-1.1)
 * Используется для создания атмосферы
 */
let lightFlicker = 1;

/**
 * Интенсивность дрожания камеры
 * Увеличивается при получении урона игроком
 */
let cameraShake = 0;

/**
 * Мощность дрожания камеры
 * Максимальная интенсивность дрожания
 */
let cameraShakePower = 8;

/**
 * Угол последнего выстрела
 * Используется для отрисовки вспышки в правильном направлении
 */
let lastShotAngle = 0;

// ===== ИГРОВЫЕ ДАННЫЕ =====
/**
 * Массив следов игрока
 * Содержит объекты с координатами, прозрачностью и размером следов
 */
let footprints = [];

/**
 * Массив следов зомби
 * Содержит объекты с координатами, прозрачностью и размером следов зомби
 */
let zombieFootprints = [];

// ===== СИСТЕМА ВОЛН =====
/**
 * Текущая волна
 * Начинается с 1, увеличивается после завершения каждой волны
 */
let wave = 1;

/**
 * Активна ли волна
 * true - волна активна (зомби спавнятся), false - волна не активна
 */
let isWaveActive = false;

/**
 * Идет ли перерыв между волнами
 * true - перерыв между волнами, false - нет перерыва
 */
let isWaveCooldown = false;

/**
 * Длительность перерыва между волнами в секундах
 */
let waveCooldownTime = 3;

/**
 * Таймер перерыва между волнами
 * Уменьшается каждый кадр, при достижении 0 начинается новая волна
 */
let waveTimer = 0;

/**
 * Количество зомби в текущей волне
 * Используется для отображения в HUD
 */
let zombiesInWave = 0;

// Делаем переменные глобальными для доступа из других модулей
window.isWaveActive = isWaveActive;
window.isWaveCooldown = isWaveCooldown;

// ===== СИСТЕМА ЗВАНИЙ =====
/**
 * Время отображения звания (0 = скрыто)
 * Уменьшается каждый кадр, при достижении 0 звание скрывается
 */
let rankDisplayTime = 0;

/**
 * Текущее отображаемое звание
 * null если звание не показывается
 */
let currentDisplayRank = null;

/**
 * Очки при последнем звании
 * Используется для определения, получено ли новое звание
 */
let lastRankScore = 0;

// ===== СИСТЕМА ДОСТИЖЕНИЙ =====
/**
 * Время отображения достижения (0 = скрыто)
 * Уменьшается каждый кадр, при достижении 0 достижение скрывается
 */
let achievementDisplayTime = 0;

/**
 * Текущее отображаемое достижение
 * null если достижение не показывается
 */
let currentDisplayAchievement = null;

/**
 * Очередь достижений для показа
 * Если несколько достижений получены одновременно, они показываются по очереди
 */
let pendingAchievements = [];

// ===== СИСТЕМА УЛУЧШЕНИЙ =====
/**
 * Время отображения уведомления о доступном улучшении
 * Уменьшается каждый кадр, при достижении 0 уведомление скрывается
 */
let upgradeNotificationTime = 0;

/**
 * Время последней проверки доступных улучшений
 * Используется для периодической проверки доступных улучшений
 */
let lastUpgradeCheckTime = 0;

/**
 * Показывалось ли уведомление в текущей волне
 * Предотвращает повторное показывание уведомления в одной волне
 */
let upgradeNotificationShownThisWave = false;

// ===== СИСТЕМА СПАВНА =====
/**
 * Таймер для случайного спавна монеток
 * Уменьшается каждый кадр, при достижении 0 спавнится монетка
 */
let coinSpawnTimer = 0;

/**
 * Таймер для случайного спавна баффов
 * Уменьшается каждый кадр, при достижении 0 спавнится бафф
 */
let buffSpawnTimer = 0;

